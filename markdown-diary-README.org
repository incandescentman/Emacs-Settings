#+TITLE: Markdown Diary
#+AUTHOR: Jay Dixit
#+OPTIONS: toc:nil num:nil

* Overview
The ~markdown-diary.el~ module extends Emacs' built-in Calendar and Diary system with Markdown support, enabling seamless journaling, planning, and event tracking inside a plain-text diary file (~jay-diary.md~). It bridges the visual navigation of Emacs Calendar with a clean, chronological Markdown format suitable for version control and reading outside Emacs.

* Features
- üìÜ *Calendar Integration*: Navigate dates in the Emacs Calendar and jump directly to corresponding entries in your Markdown diary.
- ‚úçÔ∏è *Markdown Diary Format*: Keeps entries organized hierarchically by year and month using Markdown headings:
  #+begin_example
  # 2025
  ** January 2025
  1/2/2025
   - Meet with Claire
  #+end_example
- ü™∂ *Automatic Chronological Sorting*: New entries are inserted in the correct year/month section in date order.
- üß≠ *Smart Navigation & Focus Control*:
 - ~RET~ --- Open the Markdown diary entry for the selected date.
 - ~e~ --- Open the entry and move the cursor to the end of the last bullet (ready to type).
 - ~v~, ~o~, or ~SPC~ --- View the diary entry while keeping focus in the calendar.
 - ~O~ --- Show the fancy diary listing for that date.
 - ~i~ / ~c~ --- Insert a new diary entry.
 - ~C~ --- Insert a new entry using the most recent minibuffer history text.
 - ~t~ --- Jump to today and open the diary entry.
- ü™ü *Focus Persistence*: Calendar windows and diary buffers remember their layout---no more window chaos when switching between them.
- ü™Ñ *Graceful Layout Management*: Automatically closes "Fancy Diary" display windows to preserve your layout.

* Keybindings Summary
| Key | Command | Description |
|-----|----------|-------------|
| ~RET~ | =my-calendar-edit-diary-entry= | Jump to diary entry for the selected date |
| ~e~ | =my-calendar-edit-diary-entry= | Jump to entry and move point to end of bullets |
| ~v~, ~o~, ~SPC~ | =my-calendar-view-diary-entry= | View entry but stay in calendar |
| ~O~ | =my-calendar-show-fancy-diary-listing= | Show fancy diary listing for date |
| ~i~, ~c~ | =my-calendar-insert-diary-entry= | Insert a new diary entry |
| ~C~ | =my-calendar-insert-diary-entry-and-autopopulate= | Insert entry prefilled with last input |
| ~t~ | --- | Jump to today and open entry |

* File Structure
Your diary lives at:
#+begin_example
/Users/jay/Dropbox/github/timeless/data/jay-diary.md
#+end_example
Entries are grouped like:
#+begin_example
* 2025
** March 2025
3/15/2025
 - Speak at SXSW EDU
 - Dinner with friends
#+end_example

* Implementation Details
- The diary file is manipulated using helper functions prefixed with =my-calendar--=.
- The insertion logic ensures each entry is correctly placed within a valid month region.
- Blank-line normalization ensures every date and section is surrounded by readable spacing.
- Compatible with modern Emacs (‚â• 29), including those where =calendar-month-alist= isn't automatically provided.

* Requirements
- Emacs 28 or newer.
- The built-in Calendar and Diary packages.
- Markdown-mode for editing the diary file.

* Installation
1. Place ~markdown-diary.el~ in your =load-path= (for example, under =~/.emacs.d/lisp/=).
2. Add to your init file:
   #+begin_src emacs-lisp
   (require 'markdown-diary)
   #+end_src
3. Open the Calendar with =M-x calendar= and use the keybindings above.

* Example Workflow
1. Open Calendar with =M-x calendar=.
2. Navigate to a date.
3. Press ~e~ to edit or add entries.
4. Press ~v~ or ~SPC~ to preview entries without leaving the Calendar.
5. Press ~t~ to jump to today's entry and log your notes.

* License
Copyright (c) 2025 Jay Dixit.
Licensed under the MIT License. 
