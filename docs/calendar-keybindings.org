#+TITLE: Calendar & Markdown Diary Keybindings
#+AUTHOR: Jay Dixit
#+DATE: <2025-10-14>

This reference lists the active keybindings that connect the Emacs Calendar buffer with the Markdown diary maintained by ~markdown-diary.el~.

* Calendar Mode Bindings
These bindings live in ~calendar-mode-map~.

~RET~, ~e~   ~my-calendar-edit-diary-entry~
     - Jump to the diary entry for the selected date, land at the end of the last bullet, and keep focus in the diary buffer.

~o~, ~v~, ~SPC~   ~my-calendar-view-diary-entry~
     - Reveal the selected date in the diary window while leaving point in the Calendar buffer.

~O~   ~my-calendar-show-fancy-diary-listing~
     - Show the fancy diary listing for the date at point, then reselect the Calendar window.

~M-t~   ~my-calendar-toggle-last-date~
     - Toggle between today and the previously visited date like a mark ring.

~/~, ~s~   ~my-diary-search~
     - Run a consult-ripgrep search across the diary from within the calendar.

~?~   ~my-calendar-help~
     - Pop up an in-buffer cheat sheet of these custom bindings; press `q` to close.

~t~   today + diary
     - Move to today and immediately display todayâ€™s diary entry.

~n~, ~M-<right>~   month forward
     - Advance one month.

~p~, ~M-<left>~   month backward
     - Go back one month.

~N~   year forward
     - Advance one year.

~P~   year backward
     - Go back one year.

~i~   ~my-calendar-insert-diary-entry~
     - Prompt for Markdown text, insert it chronologically, and return to the Calendar window.

~c~   ~my-calendar-insert-diary-entry~
     - Same as ~i~, but starts with an empty minibuffer even if history exists.

~C~   ~my-calendar-insert-diary-entry-and-autopopulate~
     - Seed the minibuffer with your most recent entry text for quick reuse.

~C-u i~   ~my-calendar-insert-diary-entry~
     - Same as above, but remain in the diary buffer (prefix argument).

~C-u C~   ~my-calendar-insert-diary-entry-and-autopopulate~
     - Autopopulate with history and keep focus in the diary buffer.

~I~   ~calendar-insert-diary-entry~
     - Stock Emacs inserter kept as a fallback, Markdown-agnostic.

* Markdown Diary Helpers
The diary lives in ~~/Dropbox/github/timeless/jay-diary.md~ and is displayed in ~markdown-mode~.

~s-.~ (Command-.)   ~my-calendar-focus-calendar-window~
     - Refocus the Calendar window from within the diary buffer and close any diary listing panes so the view stays diary + calendar.

~C-SPC~   ~my-diary-return-to-calendar~
     - From within the diary buffer, jump back to Calendar at the date you originally opened.

~/~, ~s~   ~my-diary-search~
     - Search all diary entries from inside the diary buffer via consult-ripgrep.

* Behaviour Notes
Entry insertion ensures headings for the correct year and month, maintains chronological day ordering, and enforces a blank line before each ~M/D/YYYY~ block. Newly inserted text retains Markdown bullets (no Org conversion) and appends additional bullets to existing dates without duplication. All helpers are defined in ~markdown-diary.el~ and loaded via ~shared-functions.org~.
