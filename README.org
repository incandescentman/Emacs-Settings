#+TITLE: Jay's Emacs Configuration
#+AUTHOR: Jay
#+DATE: 2025-09-18

* Overview
This is a sophisticated Emacs configuration that uses Spacemacs as its foundation while incorporating extensive customizations through literate programming (org-mode files that tangle to elisp) and modular design patterns.

* Configuration Architecture

** Core Structure
- *Framework*: Spacemacs (with option for standalone GNU Emacs)
- *Primary Config*: [[file:spacemacs.d/init.el][spacemacs.d/init.el]] (Spacemacs layers and configuration)
- *Secondary Config*: [[file:gnu-emacs-startup.el][gnu-emacs-startup.el]] (standalone GNU Emacs option)
- *Shared Functions*: [[file:shared-functions.org][shared-functions.org]] → [[file:shared-functions.el][shared-functions.el]] (large collection of utilities)
- *Additional Config*: [[file:spacemacs-new-config.el][spacemacs-new-config.el]] (loaded by Spacemacs init)

** Key Components

*** Literate Programming Files (*.org → *.el)
- [[file:shared-functions.org][shared-functions.org]] - Core utilities and functions
- [[file:pasteboard-copy-and-paste-functions.org][pasteboard-copy-and-paste-functions.org]] - macOS clipboard integration
- [[file:spacecraft-mode.org][spacecraft-mode.org]] - Custom writing mode
- [[file:gnu-emacs-startup.org][gnu-emacs-startup.org]] - Alternative startup configuration
- [[file:fonts-and-themes.org][fonts-and-themes.org]] - Appearance configuration
- Auto-tangling enabled via =#+auto_tangle: t= header

*** Platform Integration
- [[file:jay-osx.el][jay-osx.el]] - macOS specific settings and =key-minor-mode-map= definition
- [[file:pasteboard-copy-and-paste-functions.el][pasteboard-copy-and-paste-functions.el]] - Enhanced clipboard operations
- [[file:reveal-in-finder.el][reveal-in-finder.el]] - Finder integration

*** Org-Mode & Knowledge Management
- [[file:jay-org-roam-suite/][jay-org-roam-suite/]] - **Core Architecture**: Modular Org Roam system (Core, Profiles, Templates)
- [[file:org-roam-config.el][org-roam-config.el]] - Legacy entry point (delegates to suite)
- =org-roam-ui= - Interactive graph visualization for org-roam (keybinding: =s-u u=)
- [[file:org-yt.el][org-yt.el]] - YouTube link support
- [[file:org-visual-style.el][org-visual-style.el]] - Visual enhancements for org-mode

*** Publishing & Export
- [[file:latex-templates/][latex-templates/]] - Extensive library of custom LaTeX classes (CVs, Books, Letters)

*** UI and Editing
- [[file:keys.el][keys.el]] - Global keybinding overrides
- [[file:fonts-and-themes.el][fonts-and-themes.el]] - Dynamic font sizing and theme management
- [[file:smart-return.el][smart-return.el]] - Context-aware return key behavior (opens image Org links and file:// paths)
- [[file:spacecraft-mode.el][spacecraft-mode.el]] - Distraction-free writing environment

*** Utility Modules
- [[file:search-commands.el][search-commands.el]] - Enhanced search functionality
- [[file:hydras.el][hydras.el]] - Hydra configurations for quick commands
- [[file:skeletons.el][skeletons.el]] - Code templates and snippets
- [[file:auto-capitalize.el][auto-capitalize.el]] - Smart capitalization

** Loading Order
1. Spacemacs core initialization
2. Layer configuration (org, auto-completion, compleseus, etc.)
3. =spacemacs-new-config.el=
4. =jay-osx.el= (provides key-minor-mode-map)
5. =gnu-emacs-startup.el=
6. =shared-functions.el=
7. Various feature modules (deferred or immediate)
8. Local configuration (=local-config.el=)

* Recent Major Updates (Oct-Nov 2025)

### 1. Org Roam Profile System (Nov 2025)
- **Multi-Graph Support**: Distinct profiles for 'Work' (default), 'My Life', 'Social', and 'Parents'.
- **Architecture**: Modularized into `jay-org-roam-suite/` (Core, Profiles, Templates).
- **Features**: Independent databases, capture templates, and export paths per profile.
- **Commands**: `s-u P` to switch, `s-u 1/2/3/4` shortcuts.

### 2. Documentation Overhaul (Oct 2025)
- **Complete Rewrite**: Transformed technical notes into user-friendly guides (`instructions.org`, `design-architecture.org`).
- **New Guides**: Added `ORG-ROAM-PROFILES-README.md`, `pasteboard-markdown-detection.org`.
- **Philosophy**: Shifted to "comprehensive guides teaching concepts".

### 3. Pasteboard & Editor Hardening
- **Pure Elisp**: Converted `pasteboard-copy-and-paste-functions` to pure `.el` for reliability.
- **Smart Paste**: Improved Markdown detection, blockquote handling, and table formatting.
- **Formatting**: Added `scripts/org_spacing_formatter.py` for automatic heading spacing.

### 4. LaTeX & Publishing
- **New Templates**: Added 'Hipster CV' and 'Elegant Less Whitespace' templates in `latex-templates/`.
- **Export**: Enhanced `ox-astro` integration with profile-aware source roots.

### 5. System Stability
- **Cloud Storage**: Fixed critical Dropbox/CloudStorage path resolution issues and timeouts.
- **File Watchers**: Optimized `file-notify` to prevent sync errors with mobile edits.
- **Startup**: Cleaned up unused packages and deprecated variables.

* Configuration Patterns

** Good Practices Already in Place
- Literate programming for documentation
- Modular file organization
- Deferred loading for performance
- Platform-specific customizations isolated
- Version control with recovery scripts
- Custom layer for Spacemacs integration

** Areas for Enhancement
- Dependency management between modules
- Better separation of concerns
- More consistent error handling
- Automated testing/validation
- Performance monitoring

* Key Dependencies
- *External*: Spacemacs, org-roam, Hunspell, various ELPA packages
- *Internal*: =key-minor-mode-map= (defined in jay-osx.el)
- *Paths*: ~/emacs/Spelling/, ~/Dropbox/writing/, various project directories

* Notes for Future Sessions
1. Review startup messages for any remaining warnings
2. Profile load times to identify bottlenecks (if performance becomes an issue)
3. Consider migrating to use-package for all package configuration
4. Review and update deprecated org-mode variables
5. Set up proper error handling for missing dependencies

* Note on File Size
- [[file:shared-functions.org][shared-functions.org]]: ~316KB (9983 lines)
  - *Splitting not recommended*: For a personal config, having everything in one searchable file is actually more convenient than managing multiple files with inter-dependencies. The monolithic approach is working well - Emacs handles it fine, and it's easier to maintain when you know where everything is
- [[file:spacemacs.d/init.el][spacemacs.d/init.el]]: ~50K lines
- [[file:gnu-emacs-startup.el][gnu-emacs-startup.el]]: ~46K lines
- [[file:pasteboard-copy-and-paste-functions.el][pasteboard-copy-and-paste-functions.el]]: ~33K lines
